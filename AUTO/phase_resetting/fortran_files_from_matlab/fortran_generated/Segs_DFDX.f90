      t2 = a*x1_vec3
      t3 = a*x2_vec3
      t4 = x1_vec3+1.0D0
      t5 = x2_vec3+1.0D0
      t6 = T*k*x4_vec3
      t7 = T*theta_new*w1_vec3
      t8 = T*theta_new*x1_vec3
      t9 = theta_old-1.0D0
      t10 = theta_new-1.0D0
      t11 = -x1_vec1
      t12 = -x2_vec1
      t13 = T*gam*theta_new*w1_vec1
      t14 = T*gam*theta_new*x1_vec1
      t17 = T*a*gam*theta_new*w1_vec2
      t18 = T*a*gam*theta_new*x1_vec2
      t15 = t2+1.0D0
      t16 = t3+1.0D0
      t19 = -t7
      t20 = -t8
      t21 = T*gam*t4*theta_new
      t22 = t11+x1_vec2+1.0D0
      t23 = t12+x2_vec2+1.0D0
      t24 = T*t10*w2_vec3
      t25 = T*t9*x3_vec3
      t26 = T*t10*x2_vec3
      t27 = T*gam*t10*w2_vec1
      t28 = T*gam*t10*x2_vec1
      t30 = T*a*gam*t10*w2_vec2
      t31 = T*a*gam*t10*x2_vec2
      t35 = T*gam*t5*t10
      t37 = t7+t17
      t29 = T*gam*t15*theta_new
      t32 = -t24
      t33 = -t26
      t34 = -t27
      t36 = T*t22*theta_new
      t38 = -t30
      t39 = t13+t19
      t40 = T*gam*t10*t16
      t41 = T*t10*t23
      t42 = t24+t34
      t43 = t32+t38
      A0(1,1) = -t21
      A0(1,3) = T*gam*t11*theta_new
      A0(2,2) = -t29
      A0(2,3) = -t18
      A0(3,1) = t8
      A0(3,2) = t20
      A0(3,3) = -t36
      A0(4,3) = t39
      A0(4,4) = t21
      A0(4,6) = t20
      A0(5,3) = t37
      A0(5,5) = t29
      A0(5,6) = t8
      A0(6,1) = t39
      A0(6,2) = t37
      A0(6,4) = t14
      A0(6,5) = t18
      A0(6,6) = t36
      A0(7,7) = t35
      A0(7,9) = t28
      A0(8,8) = t40
      A0(8,9) = t31
      A0(9,7) = t33
      A0(9,8) = t26
      A0(9,9) = t41
      A0(10,9) = t42
      A0(10,10) = -t35
      A0(10,12) = t26
      A0(11,9) = t43
      A0(11,11) = -t40
      A0(11,12) = t33
      A0(12,7) = t42
      A0(12,8) = t43
      A0(12,10) = T*gam*t10*t12
      A0(12,11) = -t31
      A0(12,12) = -t41
      A0(13,13) = T*gam*t9*(x3_vec3+1.0D0)
      A0(13,15) = T*gam*t9*x3_vec1
      A0(14,14) = T*gam*t9*(a*x3_vec3+1.0D0)
      A0(14,15) = T*a*gam*t9*x3_vec2
      A0(15,13) = -t25
      A0(15,14) = t25
      A0(15,15) = T*t9*(-x3_vec1+x3_vec2+1.0D0)
      A0(16,16) = -T*gam*k*(x4_vec3+1.0D0)
      A0(16,18) = -T*gam*k*x4_vec1
      A0(17,17) = -T*gam*k*(a*x4_vec3+1.0D0)
      A0(17,18) = -T*a*gam*k*x4_vec2
      A0(18,16) = t6
      A0(18,17) = -t6
      A0(18,18) = -T*k*(-x4_vec1+x4_vec2+1.0D0)
