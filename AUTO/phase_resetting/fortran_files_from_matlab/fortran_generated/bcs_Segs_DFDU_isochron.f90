      t2 = abs(w1_seg21)
      t3 = abs(w1_seg22)
      t4 = abs(w1_seg23)
      t5 = x0_seg21*2.0D0
      t6 = x0_seg22*2.0D0
      t7 = x0_seg23*2.0D0
      t8 = x1_seg41*2.0D0
      t9 = x1_seg42*2.0D0
      t10 = x1_seg43*2.0D0
      t11 = t2**2
      t12 = t3**2
      t13 = t4**2
      t14 = t11+t12+t13
      t15 = 1.0D0/sqrt(t14)
      A0(1,1) = 1.0D0
      A0(1,25) = -1.0D0
      A0(2,2) = 1.0D0
      A0(2,26) = -1.0D0
      A0(3,3) = 1.0D0
      A0(3,27) = -1.0D0
      A0(4,7) = -1.0D0
      A0(4,19) = 1.0D0
      A0(5,8) = -1.0D0
      A0(5,20) = 1.0D0
      A0(6,9) = -1.0D0
      A0(6,21) = 1.0D0
      A0(7,1) = -gam*(x0_seg13+1.0D0)
      A0(7,3) = -gam*x0_seg11
      A0(8,10) = -1.0D0
      A0(8,22) = 1.0D0
      A0(9,11) = -1.0D0
      A0(9,23) = 1.0D0
      A0(10,12) = -1.0D0
      A0(10,24) = 1.0D0
      A0(11,4) = mu_s
      A0(11,28) = -1.0D0
      A0(12,5) = mu_s
      A0(12,29) = -1.0D0
      A0(13,6) = mu_s
      A0(13,30) = -1.0D0
      A0(14,28) = t2*t15*((w1_seg21/abs(w1_seg21)))
      A0(14,29) = t3*t15*((w1_seg22/abs(w1_seg22)))
      A0(14,30) = t4*t15*((w1_seg23/abs(w1_seg23)))
      A0(15,1) = -1.0D0
      A0(15,31) = 1.0D0
      A0(16,2) = -1.0D0
      A0(16,32) = 1.0D0
      A0(17,3) = -1.0D0
      A0(17,33) = 1.0D0
      A0(18,13) = -1.0D0
      A0(18,16) = 1.0D0
      A0(19,14) = -1.0D0
      A0(19,17) = 1.0D0
      A0(20,15) = -1.0D0
      A0(20,18) = 1.0D0
      A0(21,7) = -w0_seg21
      A0(21,8) = -w0_seg22
      A0(21,9) = -w0_seg23
      A0(21,10) = -x0_seg21+x1_seg41
      A0(21,11) = -x0_seg22+x1_seg42
      A0(21,12) = -x0_seg23+x1_seg43
      A0(21,34) = w0_seg21
      A0(21,35) = w0_seg22
      A0(21,36) = w0_seg23
      A0(22,7) = t5-t8
      A0(22,8) = t6-t9
      A0(22,9) = t7-t10
      A0(22,34) = -t5+t8
      A0(22,35) = -t6+t9
      A0(22,36) = -t7+t10
      A0(23,16) = -1.0D0
      A0(24,17) = -1.0D0
      A0(25,18) = -1.0D0
