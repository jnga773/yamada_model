      t2 = -A_pump
      t3 = -B
      t4 = theta_old-1.0D0
      t5 = theta_new-1.0D0
      t6 = -x1_vec1
      t7 = -x2_vec1
      t8 = T*theta_new*w1_vec3*x1_vec3
      t9 = t6+x1_vec2+1.0D0
      t10 = t7+x2_vec2+1.0D0
      t11 = T*t5*w2_vec3*x2_vec3
      A0(1,1) = -T*gam*theta_new*(t2+x1_vec1+x1_vec1*x1_vec3)
      A0(2,1) = -T*gam*theta_new*(t3+x1_vec2+a*x1_vec2*x1_vec3)
      A0(3,1) = -T*t9*theta_new*x1_vec3
      A0(4,1) = -t8+T*gam*theta_new*w1_vec1*(x1_vec3+1.0D0)
      A0(5,1) = t8+T*gam*theta_new*w1_vec2*(a*x1_vec3+1.0D0)
      A0(6,1) = T*t9*theta_new*w1_vec3+T*gam*theta_new*w1_vec1*x1_vec1+T
     &*a*gam*theta_new*w1_vec2*x1_vec2
      A0(7,1) = T*gam*t5*(t2+x2_vec1+x2_vec1*x2_vec3)
      A0(8,1) = T*gam*t5*(t3+x2_vec2+a*x2_vec2*x2_vec3)
      A0(9,1) = T*t5*t10*x2_vec3
      A0(10,1) = t11-T*gam*t5*w2_vec1*(x2_vec3+1.0D0)
      A0(11,1) = -t11-T*gam*t5*w2_vec2*(a*x2_vec3+1.0D0)
      A0(12,1) = -T*t5*t10*w2_vec3+T*gam*t5*t7*w2_vec1-T*a*gam*t5*w2_vec
     &2*x2_vec2
      A0(13,1) = T*gam*t4*(t2+x3_vec1+x3_vec1*x3_vec3)
      A0(14,1) = T*gam*t4*(t3+x3_vec2+a*x3_vec2*x3_vec3)
      A0(15,1) = T*t4*x3_vec3*(-x3_vec1+x3_vec2+1.0D0)
      A0(16,1) = -T*gam*k*(t2+x4_vec1+x4_vec1*x4_vec3)
      A0(17,1) = -T*gam*k*(t3+x4_vec2+a*x4_vec2*x4_vec3)
      A0(18,1) = -T*k*x4_vec3*(-x4_vec1+x4_vec2+1.0D0)
