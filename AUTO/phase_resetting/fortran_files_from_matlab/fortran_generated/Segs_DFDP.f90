      t2 = a*x1_vec3
      t3 = a*x2_vec3
      t4 = x1_vec1*x1_vec3
      t5 = x2_vec1*x2_vec3
      t6 = x3_vec1*x3_vec3
      t7 = x4_vec1*x4_vec3
      t8 = x1_vec3+1.0D0
      t9 = x2_vec3+1.0D0
      t10 = T*gam*k
      t11 = T*gam*theta_new
      t12 = -A_pump
      t13 = -B
      t14 = T*w1_vec3*x1_vec3
      t15 = T*w2_vec3*x2_vec3
      t18 = a*x3_vec2*x3_vec3
      t19 = a*x4_vec2*x4_vec3
      t20 = theta_new*w1_vec3*x1_vec3
      t21 = theta_old-1.0D0
      t22 = theta_new-1.0D0
      t23 = -x1_vec1
      t24 = -x2_vec1
      t25 = -x3_vec1
      t26 = -x4_vec1
      t16 = t2*x1_vec2
      t17 = t3*x2_vec2
      t27 = t2+1.0D0
      t28 = t3+1.0D0
      t29 = t22*w2_vec3*x2_vec3
      t30 = t23+x1_vec2+1.0D0
      t31 = t24+x2_vec2+1.0D0
      t32 = t25+x3_vec2+1.0D0
      t33 = t26+x4_vec2+1.0D0
      t34 = T*gam*t21
      t35 = T*gam*t22
      t36 = t4+t12+x1_vec1
      t37 = t5+t12+x2_vec1
      t38 = t6+t12+x3_vec1
      t39 = t7+t12+x4_vec1
      t44 = t13+t18+x3_vec2
      t45 = t13+t19+x4_vec2
      t40 = -t34
      t41 = -t35
      t42 = t13+t16+x1_vec2
      t43 = t13+t17+x2_vec2
      A0(1,1) = -T*t36*theta_new
      A0(1,2) = t11
      A0(1,5) = -gam*t36*theta_new
      A0(1,8) = -T*gam*t36
      A0(2,1) = -T*t42*theta_new
      A0(2,3) = t11
      A0(2,4) = -t11*x1_vec2*x1_vec3
      A0(2,5) = -gam*t42*theta_new
      A0(2,8) = -T*gam*t42
      A0(3,5) = -t30*theta_new*x1_vec3
      A0(3,8) = -T*t30*x1_vec3
      A0(4,1) = T*t8*theta_new*w1_vec1
      A0(4,5) = -t20+gam*t8*theta_new*w1_vec1
      A0(4,8) = -t14+T*gam*t8*w1_vec1
      A0(5,1) = T*t27*theta_new*w1_vec2
      A0(5,4) = t11*w1_vec2*x1_vec3
      A0(5,5) = t20+gam*t27*theta_new*w1_vec2
      A0(5,8) = t14+T*gam*t27*w1_vec2
      A0(6,1) = T*theta_new*w1_vec1*x1_vec1+T*a*theta_new*w1_vec2*x1_vec
     &2
      A0(6,4) = t11*w1_vec2*x1_vec2
      A0(6,5) = t30*theta_new*w1_vec3+gam*theta_new*w1_vec1*x1_vec1+a*ga
     &m*theta_new*w1_vec2*x1_vec2
      A0(6,8) = T*t30*w1_vec3+T*gam*w1_vec1*x1_vec1+T*a*gam*w1_vec2*x1_v
     &ec2
      A0(7,1) = T*t22*t37
      A0(7,2) = t41
      A0(7,5) = gam*t22*t37
      A0(7,8) = T*gam*t37
      A0(8,1) = T*t22*t43
      A0(8,3) = t41
      A0(8,4) = t35*x2_vec2*x2_vec3
      A0(8,5) = gam*t22*t43
      A0(8,8) = T*gam*t43
      A0(9,5) = t22*t31*x2_vec3
      A0(9,8) = T*t31*x2_vec3
      A0(10,1) = -T*t9*t22*w2_vec1
      A0(10,5) = t29-gam*t9*t22*w2_vec1
      A0(10,8) = t15-T*gam*t9*w2_vec1
      A0(11,1) = -T*t22*t28*w2_vec2
      A0(11,4) = t41*w2_vec2*x2_vec3
      A0(11,5) = -t29-gam*t22*t28*w2_vec2
      A0(11,8) = -t15-T*gam*t28*w2_vec2
      A0(12,1) = T*t22*t24*w2_vec1-T*a*t22*w2_vec2*x2_vec2
      A0(12,4) = t41*w2_vec2*x2_vec2
      A0(12,5) = -t22*t31*w2_vec3+gam*t22*t24*w2_vec1-a*gam*t22*w2_vec2*
     &x2_vec2
      A0(12,8) = -T*t31*w2_vec3+T*gam*t24*w2_vec1-T*a*gam*w2_vec2*x2_vec
     &2
      A0(13,1) = T*t21*t38
      A0(13,2) = t40
      A0(13,5) = gam*t21*t38
      A0(13,7) = T*gam*t38
      A0(14,1) = T*t21*t44
      A0(14,3) = t40
      A0(14,4) = t34*x3_vec2*x3_vec3
      A0(14,5) = gam*t21*t44
      A0(14,7) = T*gam*t44
      A0(15,5) = t21*t32*x3_vec3
      A0(15,7) = T*t32*x3_vec3
      A0(16,1) = -T*k*t39
      A0(16,2) = t10
      A0(16,5) = -gam*k*t39
      A0(16,6) = -T*gam*t39
      A0(17,1) = -T*k*t45
      A0(17,3) = t10
      A0(17,4) = -t10*x4_vec2*x4_vec3
      A0(17,5) = -gam*k*t45
      A0(17,6) = -T*gam*t45
      A0(18,5) = -k*t33*x4_vec3
      A0(18,6) = -T*t33*x4_vec3
